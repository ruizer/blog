(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{383:function(s,e,n){"use strict";n.r(e);var a=n(42),r=Object(a.a)({},(function(){var s=this,e=s.$createElement,n=s._self._c||e;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"来-让我们一起来盘盘-nodejs-环境变量-process-env"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#来-让我们一起来盘盘-nodejs-环境变量-process-env"}},[s._v("#")]),s._v(" 来，让我们一起来盘盘 Nodejs 环境变量(process.env)")]),s._v(" "),n("blockquote",[n("p",[s._v("额，仅仅讨论 "),n("code",[s._v("process.env")]),s._v(" 属性，项目上常用的 NODE_ENV 啊，自己定义的 SERVER_PATH、BASEURL、VUE_APP_TITLE 啥的，怎么修改，怎么方便快速切换环境，一起来盘盘")])]),s._v(" "),n("h2",{attrs:{id:"首先-process-env-是什么"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#首先-process-env-是什么"}},[s._v("#")]),s._v(" 首先 process.env 是什么？")]),s._v(" "),n("p",[s._v("官方解释："),n("code",[s._v("process")]),s._v(" 对象是一个全局变量，提供了有关当前 "),n("code",[s._v("Node.js")]),s._v(" 进程的信息并对其进行控制；而 "),n("code",[s._v("process.env")]),s._v(" 属性会返回包含用户环境的对象，如下所示(官方示例)：")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("{\n  TERM: 'xterm-256color',\n  SHELL: '/usr/local/bin/bash',\n  USER: 'nodejscn',\n  PATH: '~/.bin/:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin',\n  PWD: '/Users/nodejscn',\n  EDITOR: 'vim',\n  SHLVL: '1',\n  HOME: '/Users/nodejscn',\n  LOGNAME: 'nodejscn',\n  _: '/usr/local/bin/node'\n}\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br")])]),n("p",[s._v("对，它是一个对象，不是我的对象，也不是你的对象～")]),s._v(" "),n("p",[s._v("它是 Nodejs 应用程序中，"),n("code",[s._v("process.env")]),s._v(" 属性，返回包含用户环境的对象，所以它不可以在客户端侧代码中使用，简单得来说就是浏览器上，打包后的静态资源。")]),s._v(" "),n("p",[s._v("这时候就有人说了(假如)：不对啊，人家在写 "),n("code",[s._v("Vue")]),s._v(" 项目的时候，可以在使用啊；比如 "),n("code",[s._v("VUE_APP_TITLE")]),s._v("，可以这样访问：")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("console.log(process.env.VUE_APP_TITLE)\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("懂的同学马上就懂了，不懂的同学你来看："),n("code",[s._v("VUE_APP_TITLE")]),s._v("，标重点了，"),n("strong",[s._v("VUE_APP")]),s._v("。")]),s._v(" "),n("p",[s._v("是不是有那么一丝明悟，对的，在写 Vue 项目时，在客户端侧代码中，只有以 "),n("code",[s._v("VUE_APP_")]),s._v(" 开头的变量会被 "),n("code",[s._v("webpack.DefinePlugin")]),s._v(" 静态嵌入到客户端侧的包中，你才可以在应用的代码中访问它们；当然，还有两个特殊的变量也可以在应用中访问："),n("code",[s._v("NODE_ENV")]),s._v(" 和 "),n("code",[s._v("BASE_URL")]),s._v("；来自官方的解释："),n("a",{attrs:{href:"https://cli.vuejs.org/zh/guide/mode-and-env.html#%E5%9C%A8%E5%AE%A2%E6%88%B7%E7%AB%AF%E4%BE%A7%E4%BB%A3%E7%A0%81%E4%B8%AD%E4%BD%BF%E7%94%A8%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F",target:"_blank",rel:"noopener noreferrer"}},[s._v("传送门"),n("OutboundLink")],1)]),s._v(" "),n("p",[s._v("同样在 "),n("code",[s._v("React")]),s._v(" 应用中，除了一些内置变量（ "),n("code",[s._v("NODE_ENV")]),s._v(" 和 "),n("code",[s._v("PUBLIC_URL")]),s._v(" ）之外，变量名必须以 "),n("code",[s._v("REACT_APP_")]),s._v(" 开头才能使用。")]),s._v(" "),n("h2",{attrs:{id:"如何修改"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#如何修改"}},[s._v("#")]),s._v(" 如何修改？")]),s._v(" "),n("p",[s._v("要好好的使用 "),n("code",[s._v("process.env")]),s._v("，当然要知道如何修改它，就比如交往了一个女朋友，好吧，我没有女朋友。")]),s._v(" "),n("p",[s._v("言归正传，怎么修改呢？")]),s._v(" "),n("p",[s._v("答：直接赋值。")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("process.env.girlfriend = 100\nconsole.log(process.env.girlfriend)\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[s._v("咦，怎么打印出来的是字符串？聪明的同学已经发现了。")]),s._v(" "),n("p",[n("s",[s._v("我们不推荐这样的行为，不要做渣男，要一心一意。")])]),s._v(" "),n("p",[s._v("嗯，我们确实不推荐这样的行为，因为在 "),n("code",[s._v("process.env")]),s._v(" 上为属性赋值会隐式地将值转换为字符串：")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("process.env.girlfriend = true;\nconsole.log(process.env.girlfriend);\n// => 'true'\n\nprocess.env.girlfriend = 1;\nconsole.log(process.env.girlfriend);\n// => '1'\n\nprocess.env.girlfriend = null;\nconsole.log(process.env.girlfriend);\n// => 'null'\n\nprocess.env.girlfriend = undefined;\nconsole.log(process.env.girlfriend);\n// => 'undefined'\n\nprocess.env.girlfriend = {a: 'aa'};\nconsole.log(process.env.girlfriend);\n// => '[object Object]'\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br")])]),n("p",[s._v("并且，当值不是字符串、数字或布尔值时，Node.js 未来的版本可能会抛出错误。")]),s._v(" "),n("p",[s._v("增删改查，如何删呢？直接 "),n("code",[s._v("delete")]),s._v(" 就行了：")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("process.env.girlfriend = 1;\ndelete process.env.girlfriend\nconsole.log(process.env.girlfriend);\n// => undefined\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("p",[n("strong",[s._v("注意")]),s._v("，在 "),n("code",[s._v("Windows")]),s._v(" 操作系统上，环境变量没有大小写之分：")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("process.env.GIRLFRIEND = 1;\nconsole.log(process.env.girlfriend);\n// => 'q'\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("h2",{attrs:{id:"如何方便的切换环境"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#如何方便的切换环境"}},[s._v("#")]),s._v(" 如何方便的切换环境？")]),s._v(" "),n("p",[s._v("在公司中，一个项目一般会有开发版本、测试版本、线上版本，也许还有预上线版本，每个版本对应不同参数，比如请求的 API 地址，或者图像字体资源地址等等；")]),s._v(" "),n("p",[s._v("为了方便管理，我们通常做成配置文件的形式，根据不同的环境，加载不同的文件。毕竟我还要找女朋友，不能太 "),n("strong",[s._v("low")]),s._v(" 了。")]),s._v(" "),n("h3",{attrs:{id:"修改-package-json-文件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#修改-package-json-文件"}},[s._v("#")]),s._v(" 修改 package.json 文件")]),s._v(" "),n("p",[s._v("比如我们现在要设置的环境变量 "),n("strong",[s._v("girlfriend")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('{\n  ...,\n  "scripts": {\n    "normal": "export girlfriend=\'woman\' && node friend.js",\n    "sages": "export girlfriend=\'monster\' && node friend.js" // 在windows上export要换成set\n  },\n  ...\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("p",[n("code",[s._v("npm run normal")]),s._v(" 就是正常模式")]),s._v(" "),n("p",[n("code",[s._v("npm run sages")]),s._v(" 就是贤者模式")]),s._v(" "),n("p",[s._v("现在，我们可以通过配置 "),n("code",[s._v("package.json")]),s._v(" 来设置环境变量，就可以在代码中获取对应的值，所以我们就可以很轻松的换环境了。")]),s._v(" "),n("p",[s._v("别急，可以使用 "),n("a",{attrs:{href:"https://www.npmjs.com/cross-env",target:"_blank",rel:"noopener noreferrer"}},[s._v("cross-env"),n("OutboundLink")],1),s._v(" 依赖包，支持跨平台配置环境变量。\n安装依赖:")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("npm install --save-dev cross-env\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("配置环境")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('"scripts": {\n  "normal": "cross-env girlfriend=\'woman\' node friend.js"\n}\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("p",[s._v("这样是不是好很多了~")]),s._v(" "),n("p",[s._v("不对啊，贤者模式有很多种情况啊，比如时长、地点等等，一大串的拼在后面也很 low。")]),s._v(" "),n("p",[s._v("其实有多种方法来解决这个问题，比如写个 "),n("code",[s._v("env")]),s._v(" 模块")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("// env.js\nmodule.exports = {\n  'normal': {\n    // 正常模式下的\n  },\n  // 其他模式\n}\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("p",[s._v("然后不同命令加载不同对象，进而修改环境变量:")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("const envConfig = require('env.js')[process.env.NODE_ENV];\nif (Object.prototype.toString.call(envConfig) === '[object Object]') {\n  for (const k in envConfig) {\n    process.env[k] = envConfig[k]\n  }\n}\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("p",[s._v("当然还有很多种方式。")]),s._v(" "),n("p",[s._v("在这里，我推荐使用 "),n("code",[s._v(".env")]),s._v("文件 结合 "),n("code",[s._v("dotenv")]),s._v(" 依赖包的方式来实现。")]),s._v(" "),n("p",[s._v("好了，我要正经起来了。")]),s._v(" "),n("h3",{attrs:{id:"关于-dotenv"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#关于-dotenv"}},[s._v("#")]),s._v(" 关于 dotenv")]),s._v(" "),n("p",[n("code",[s._v("dotenv")]),s._v(" 是一个零依赖包，可将环境变量从 "),n("code",[s._v(".env")]),s._v(" 文件加载到 "),n("code",[s._v("process.env")]),s._v("；其原理是将 "),n("code",[s._v(".env")]),s._v(" 文件解析为 "),n("code",[s._v("json")]),s._v(" 对象，并对其中的 "),n("code",[s._v("key-value")]),s._v(" 对通过 "),n("code",[s._v("process.env")]),s._v(" 将其赋值为环境变量，之后便可通过 "),n("code",[s._v("process.env[key]")]),s._v(" 来使用。")]),s._v(" "),n("p",[s._v("基本使用流程如下")]),s._v(" "),n("h4",{attrs:{id:"安装"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#安装"}},[s._v("#")]),s._v(" 安装")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("# with npm\nnpm install dotenv\n\n# or with Yarn\nyarn add dotenv\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("h3",{attrs:{id:"使用"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#使用"}},[s._v("#")]),s._v(" 使用")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("require('dotenv').config() // 默认是.env文件\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("它会把项目根目录下的 "),n("code",[s._v(".env")]),s._v(" 文件内容加载到 "),n("code",[s._v("process.env")]),s._v("。")]),s._v(" "),n("p",[s._v("我们也可以使用它的 "),n("code",[s._v("Parse")]),s._v(" 方法，拿到一个 "),n("code",[s._v("json")]),s._v(" 对象")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("const fs = require('fs')\nconst dotenv = require('dotenv')\nconst config = dotenv.parse(fs.readFileSync('.env')) // will return an object\nconsole.log(typeof config, config) // object { girlfriend : 'woman' }\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("p",[s._v("更多相关内容，请见："),n("a",{attrs:{href:"https://github.com/motdotla/dotenv",target:"_blank",rel:"noopener noreferrer"}},[s._v("传送门"),n("OutboundLink")],1)]),s._v(" "),n("h2",{attrs:{id:"分享一下我的方案"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#分享一下我的方案"}},[s._v("#")]),s._v(" 分享一下我的方案")]),s._v(" "),n("p",[s._v("首先，不同环境对应不同 "),n("code",[s._v(".env")]),s._v(" 文件，如："),n("code",[s._v(".env.beta")]),s._v("、"),n("code",[s._v(".env.prod")]),s._v("；")]),s._v(" "),n("p",[n("code",[s._v(".env")]),s._v(" 文件")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("NODE_ENV = 'development'\nHOST = 'lacalhost'\nPORT = 3000\nMONGODB_HOST = '127.0.0.1'\nMONGODB_USERNAME = 'root'\nMONGODB_PASSWORD = '123'\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("p",[n("code",[s._v(".env.prod")]),s._v(" 文件")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("NODE_ENV = 'production'\nHOST = '10.100.xx.xx'\nPORT = 3000\nMONGODB_HOST = '43.247.xx.xx'\nMONGODB_USERNAME = 'root'\nMONGODB_PASSWORD = 'xxxxxx'\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("p",[s._v("之后在 "),n("code",[s._v("scripts")]),s._v(" 命令中，使用 "),n("code",[s._v("--mode")]),s._v(" 参数来区分不同环境，并与相关文件名对应；")]),s._v(" "),n("p",[n("code",[s._v("package.json")]),s._v(" 文件")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('{\n  ...,\n  "scripts": {\n    "dev": "cross-env nodemon server/index.js --watch",\n    "prod": "cross-env node server/index.js --mode prod"\n  },\n  ...\n}\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("p",[s._v("然后在执行文件中，拿到命令参数 "),n("code",[s._v("process.argv")]),s._v("，并根据不同 "),n("code",[s._v("mode")]),s._v(" 来加载不同 "),n("code",[s._v(".env")]),s._v(" 文件，这样，我们就可以很轻松的换环境了；")]),s._v(" "),n("p",[n("code",[s._v("server/index.js")]),s._v(" 文件")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("const dotenv = require('dotenv')\nconst argv = process.argv\nconst mode = argv[2] === '--mode' ? argv[3] : ''\nconst envFile = mode ? `.env.${mode}` : '.env'\ndotenv.config({ path: envFile })\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("p",[n("strong",[s._v("问题")]),s._v("，声明命令参数必须统一，这样通过 "),n("code",[s._v("process.argv")]),s._v(" 拿到的参数才能正确。比如：")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("// package.json\n\"scripts\": {\n  \"dev\": \"cross-env nodemon server/index.js --watch --mode dev\"\n}\n\n// server/index.js\nconsole.log(process.argv)\n// => ['xxx', 'xx', 'dev']\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("p",[s._v("如果，要按照我这样的方式拿到参数，必须这样声明：")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('// package.json\n"scripts": {\n  "dev": "cross-env nodemon server/index.js --mode dev --watch"\n}\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("p",[s._v("关于 "),n("code",[s._v("process.argv")]),s._v(" 方面的内容，我不是特别明白，若有错误请见谅。")]),s._v(" "),n("h2",{attrs:{id:"最后"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#最后"}},[s._v("#")]),s._v(" 最后")]),s._v(" "),n("p",[s._v("新的一年，新的开始，希望大家在新的一年都能找到自己 "),n("strong",[s._v("对象")])]),s._v(" "),n("p",[s._v("本文完。")])])}),[],!1,null,null,null);e.default=r.exports}}]);
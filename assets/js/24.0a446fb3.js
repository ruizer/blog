(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{387:function(s,e,t){"use strict";t.r(e);var a=t(42),n=Object(a.a)({},(function(){var s=this,e=s.$createElement,t=s._self._c||e;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"原生js实现table表格列宽拖拽"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#原生js实现table表格列宽拖拽"}},[s._v("#")]),s._v(" 原生JS实现table表格列宽拖拽")]),s._v(" "),t("blockquote",[t("p",[s._v("这是我很久以前写的文章，如果有什么不对的地方请指出，原文：https://ruizer.github.io/2019/07/22/table-grad-表格列宽拖拽/")])]),s._v(" "),t("blockquote",[t("p",[s._v("本文配套"),t("a",{attrs:{href:"https://ruizer.github.io/demo/#/table-drag",target:"_blank",rel:"noopener noreferrer"}},[s._v("Demo"),t("OutboundLink")],1)])]),s._v(" "),t("p",[s._v("实现表格列宽拖拽功能，主要使用鼠标事件："),t("code",[s._v("mousedown")]),s._v("、"),t("code",[s._v("mouseup")]),s._v("、"),t("code",[s._v("mousemove")])]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",[s._v("事件")]),s._v(" "),t("th",[s._v("描述")])])]),s._v(" "),t("tbody",[t("tr",[t("td",[t("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/API/Element/mousedown_event",target:"_blank",rel:"noopener noreferrer"}},[s._v("mousedown"),t("OutboundLink")],1)]),s._v(" "),t("td",[s._v("事件在指针设备（如：鼠标）按钮按下时触发")])]),s._v(" "),t("tr",[t("td",[t("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/API/Element/mouseup_event",target:"_blank",rel:"noopener noreferrer"}},[s._v("mouseup"),t("OutboundLink")],1)]),s._v(" "),t("td",[s._v("事件在指针设备（如：鼠标）按钮抬起时触发")])]),s._v(" "),t("tr",[t("td",[t("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/API/Element/mousemove_event",target:"_blank",rel:"noopener noreferrer"}},[s._v("mousemove"),t("OutboundLink")],1)]),s._v(" "),t("td",[s._v("当指针设备( 通常指鼠标 )在元素上移动时, "),t("code",[s._v("mousemove")]),s._v(" 事件被触发")])])])]),s._v(" "),t("p",[s._v("当然，这些事件都是绑定在表头上面的，大致流程就是：\n")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("graph LR\n鼠标按下记录单元格--\x3e鼠标移动调整列宽\n鼠标移动调整列宽--\x3e鼠标抬起结束宽度调整\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("h3",{attrs:{id:"按下鼠标-mousedown"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#按下鼠标-mousedown"}},[s._v("#")]),s._v(" 按下鼠标 mousedown")]),s._v(" "),t("p",[s._v("当鼠标按下时，记录单元格")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("    /** 鼠标按下 */\n    mouseDown(e) {\n      // 记录单元格\n      if (!(e && e.target)) return;\n      this.localTd = e.target;\n      if (e.offsetX > this.localTd.offsetWidth - 10) {\n        this.localTd.mouseDown = true;\n        this.localTd.oldX = e.x;\n        this.localTd.oldWidth = this.localTd.offsetWidth;\n      }\n    }\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("h3",{attrs:{id:"移动鼠标-mousemove"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#移动鼠标-mousemove"}},[s._v("#")]),s._v(" 移动鼠标 mousemove")]),s._v(" "),t("p",[s._v("当鼠标移动时，根据暂存的单元格及宽度信息，调整列宽")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('    /** 鼠标移动 */\n    mouseMove(e) {\n      if (!(e && e.target)) return;\n      const vm = e.target;\n      // 更改鼠标样式\n      if (e.offsetX > vm.offsetWidth - 10) {\n        vm.style.cursor = "col-resize";\n      } else {\n        vm.style.cursor = "default";\n      }\n      // 取出暂存的Table Cell\n      if (!this.localTd) this.localTd = vm;\n      if (this.localTd.mouseDown !== null && this.localTd.mouseDown === true) {\n        this.localTd.style.cursor = "default";\n        if (this.localTd.oldWidth + (e.x - this.localTd.oldX) > 0) {\n          this.localTd.width =\n            this.localTd.oldWidth + (e.x - this.localTd.oldX);\n        }\n        // 调整列宽\n        this.localTd.style.width = this.localTd.width;\n        this.localTd.style.cursor = "col-resize";\n        // 调整该列中的每个Cell\n        let table = this.localTd;\n        while (table.tagName !== "TABLE") table = table.parentElement;\n        for (let j = 0; j < table.rows.length; j++) {\n          table.rows[j].cells[\n            this.localTd.cellIndex\n          ].width = this.localTd.width;\n        }\n      }\n    }\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br")])]),t("h3",{attrs:{id:"鼠标抬起-mouseup"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#鼠标抬起-mouseup"}},[s._v("#")]),s._v(" 鼠标抬起 mouseup")]),s._v(" "),t("p",[s._v("鼠标抬起，结束宽度调整")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('    /** 鼠标抬起 */\n    mouseUp(e) {\n      // 结束宽度调整\n      if (!(e && e.target)) return;\n      if (!this.localTd) this.localTd = e.target;\n      this.localTd.mouseDown = false;\n      this.localTd.style.cursor = "default";\n    }\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("p",[s._v("本文完， 感谢阅读。")])])}),[],!1,null,null,null);e.default=n.exports}}]);